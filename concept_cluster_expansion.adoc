---
sidebar: sidebar 
permalink: concept_cluster_expansion.html 
keywords: cluster, expand, expansion, single, two, node deployment workflow, workflow, deployment steps 
summary: 両方のノードをハイアベイラビリティ（HA）ペアとして構成して、既存のシングルノードクラスタを2ノードクラスタに拡張します。 
---
= クラスタを拡張
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP 9.13.1以降では、両方のノードをハイアベイラビリティ（HA）ペアとして構成することで、既存のシングルノードクラスタを2ノードクラスタに拡張できます。2ノードのHAクラスタに拡張すると高可用性が確保されるため、ノード停止によるクラスタのデータ提供機能への影響を防ぐことができます。

手順は自動化され、ONTAP Select DeployからCLIまたはWebインターフェイスを使用して開始されます。これは、システム停止を伴う手順です。

.クラスタ拡張の前提条件
クラスタの拡張手順を開始する前に、次の前提条件を満たしていることを確認します。

* 既存のノードの電源をオンにします。
* 既存のノードでクラスタの更新が完了しました。
* 既存のノードと新しいノードのESXホストの構成は同じです。
* 既存のノードと新しいノードのESXホスト間でネットワーク接続チェッカーを実行しておきます。
* ONTAP Select Deployクラスタの拡張手順を使用するには、評価用ライセンス（90日間）と本番環境（大容量階層または容量プール）ライセンスが必要です。次のライセンス要件を満たしていることを確認します。
+
--
** 新しいノードに必要な大容量階層または容量プールのライセンスが必要です。
+

NOTE: 容量プールライセンスの場合は、既存のプールの未使用容量を使用できます。必要に応じて、ライセンスをアップグレードして容量を拡張できます。

** 両方のノードに容量プールライセンスがある場合は、同じ容量プールに属しています。
** 両方のノードに同じライセンスタイプを適用しました。


--
+
2ノードクラスタの各ノード（既存および新規）のライセンス要件は、シングルノードクラスタの2倍です。

+
--
** シングルノードクラスタの場合は、データアグリゲートに対してフルライセンスを使用できます。たとえば、1TBライセンスのシングルノードでは、1TBのデータアグリゲートをホストできます。
** 2ノードクラスタの場合、ライセンス容量の半分は各ノードのデータアグリゲートに使用され、残りの半分は対応するパートナーノードのデータアグリゲートのミラーディスクに使用されます。たとえば、2TBライセンスのホストを持つ2つのノードにそれぞれ1TBのデータアグリゲートがあり、合計2TBのデータアグリゲートとして使用可能な容量が提供され、2TBがアグリゲートのミラーディスクをホストするとします。


--
+
ライセンスの詳細については、を参照してください。 link:concept_lic_evaluation.html["使用許諾"] セクション。

* ノードに接続されているデータストアが次の条件を満たしている。
+
** 既存のノード上のデータストアは、同じタイプ（VMware Virtual Machine File System（VMFS）-5、VMFS-6、NFSなど）である必要があります。
** 新しいノードに接続するデータストアのタイプは、既存のノードのデフォルトのデータストアと同じである必要があります。
** 既存のノードのデータストアには、ノードの使用済みスペース以上の空きスペースが必要です。
** 新しいノードに接続されたデータストアの空きスペースが、既存のノードの占有スペースの合計の2倍である必要があります。


* 両方のONTAP Selectノードが同じインスタンスタイプです。


.ハードウェアとソフトウェアの要件
新規および既存のノードは、ハードウェアおよびソフトウェアに関するいくつかの要件を満たしている必要があります。

* 既存のシングルノードクラスタでONTAP 9.13.1以降が実行されている。
* 既存のノードと新しいノードのESXホストが次の条件を満たしている。
+
** vCenter Server 7.0 Update 3以降をサポートしています。また、NetAppではvCenter Server 7.0以降を推奨しています。
** クラスタ間接続用の内部ネットワークがあります。


* 既存のノードと新しいノードはハードウェアRAIDタイプです。
* 小規模インスタンスタイプの場合、ノードには16GB以上のRAMと4つのCPUが搭載されます。大規模なインスタンスタイプの場合、ノードには最大128GBのRAMと16個のCPUがあります。


.クラスタの拡張に関する制限事項
ONTAP Selectクラスタの拡張に関する次の制限事項に注意してください。

* 手順では、シングルノードクラスタから2ノードクラスタへの拡張のみがサポートされます。
* データストアの合計容量は64TBに制限されています。データストレージ容量は32TBで、残りの32TBはデータミラーリング用の追加スペースです。
* クラスタの拡張は、ハードウェアRAIDノードおよびクラスタタイプでのみサポートされます。ソフトウェアRAIDタイプとハードウェアRAIDタイプの混在への拡張はサポートされていません。


次の図は、拡張前のシングルノード構成と拡張後の2ノードHAペア構成を示しています。
image:cluster_expansion_two_node.PNG["シングルノードから2ノードクラスタへの拡張図"]

.クラスタ拡張手順の開始
ONTAP Select Deployを開始してクラスタ拡張手順を実行するには、CLIから次のコマンドを実行します。

. `node add -cluster-name <cluster_name> -nodes <2nd_node_name>`
. `node modify -cluster-name <cluster_name> -name <1st_node_name> -internal-networks ONTAP-Internal`
. `node modify -cluster-name <cluster_name> -name <2nd_node_name> -mgmt-ip <node_ip> -host-name <host_name> -management-networks ONTAP-Management -internal-networks ONTAP-Internal -data-networks ONTAP-External -passthrough-disks false`
. `node storage pool attach -cluster-name <cluster_name> -node-name <2nd_node_name> -name <storage_pool_name> -capacity-limit <capacity>`
. `cluster expand -name <cluster_name>`
+
プロンプトが表示されたら、ONTAP管理者パスワードを入力します。


