---
sidebar: sidebar 
permalink: concept_ha_config.html 
keywords: ontap select, high availability configurations, two-node ha, multi-node ha, mc sds 
summary: 高可用性オプションを確認して、環境に最も適した HA 構成を選択してください。 
---
= ONTAP Selectハイアベイラビリティコウセイ
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
高可用性オプションを確認して、環境に最も適した HA 構成を選択してください。

お客様はアプリケーションワークロードをエンタープライズクラスのストレージアプライアンスからコモディティハードウェアで動作するソフトウェアベースのソリューションに移行し始めていますが、耐障害性とフォールトトレランスに対するニーズや期待は変わりません。Recovery Point Objective （ RPO ；目標復旧時点）がゼロの HA 解決策 は、インフラスタック内のコンポーネント障害によるデータ損失からお客様を保護します。

SDS市場の大部分は、シェアードナッシング ストレージの概念に基づいて構築されており、ソフトウェア レプリケーションにより、異なるストレージ サイロにユーザー データの複数のコピーを保存することでデータの復元力が提供されます。ONTAP Selectは、ONTAPが提供する同期レプリケーション機能（RAID SyncMirror）を使用してクラスター内にユーザー データの追加コピーを保存することで、この前提に基づいて構築されています。これはHAペアのコンテキスト内で発生します。すべてのHAペアは、ユーザー データのコピーを2つ保存します。1つはローカル ノードによって提供されるストレージ上に、もう1つはHAパートナーによって提供されるストレージ上に保存されます。ONTAP Selectクラスター内では、HAおよび同期レプリケーションは結び付けられており、2つの機能を切り離したり、独立して使用したりすることはできません。その結果、同期レプリケーション機能はマルチノード オファリングでのみ利用可能です。


NOTE: ONTAP Select クラスタでは、同期レプリケーション機能は HA の機能であり、非同期の SnapMirror または SnapVault レプリケーションエンジンに代わるものではありません。同期レプリケーションを HA から切り離して使用することはできません。

ONTAP Select HA導入モデルには、マルチノードクラスタ（4ノード、6ノード、8ノード、10ノード、または12ノード）と2ノードクラスタの2つがあります。2ノードONTAP Selectクラスタの顕著な特徴は、スプリットブレインシナリオを解決するために外部メディエーターサービスを使用することです。ONTAP Deploy VMは、構成するすべての2ノードHAペアのデフォルトのメディエーターとして機能します。

この 2 つのアーキテクチャを次の図に示します。

* ローカル接続ストレージ * を使用した 2 ノード ONTAP Select クラスタ。リモートメディエーター付き

image:DDHA_01.jpg["2 ノード ONTAP Select クラスタとリモートメディエーター、ローカル接続ストレージを使用"]


NOTE: 2 ノード ONTAP Select クラスタは、 1 つの HA ペアとメディエーターで構成されます。各 HA ペアでは、各クラスタノード上のデータアグリゲートが同期ミラーリングされ、フェイルオーバーが発生した場合にデータが失われることはありません。

* ローカル接続ストレージを使用する 4 ノード ONTAP Select クラスタ *image:DDHA_02.jpg["ローカル接続ストレージを使用する 4 ノード ONTAP Select クラスタ"]

* 4ノードのONTAP Selectクラスタは、2つのHAペアで構成されています。66 ノード、8 ノード、10 ノード、および 12 ノードのクラスターは、それぞれ 3、4、5、および 6 つの HA ペアで構成されます。各HAペア内では、各クラスタノードのデータアグリゲートが同期的にミラーリングされ、フェイルオーバーが発生してもデータが失われることはありません。
* DAS ストレージを使用している場合、物理サーバ上に存在できる ONTAP Select インスタンスは 1 つだけです。ONTAP Select は、システムのローカル RAID コントローラに排他的にアクセスする必要があり、かつローカル接続ディスクを管理するように設計されているため、ストレージとの物理的な接続が不可欠です。




== 2 ノード HA とマルチノード HA

FAS アレイとは異なり、HA ペア内の ONTAP Select ノードは IP ネットワーク経由でのみ通信します。つまり、IP ネットワークは単一障害点（SPOF）であり、ネットワーク パーティションやスプリット ブレイン シナリオからの保護が設計の重要な側面になります。マルチノード クラスタは、3 つ以上の存続ノードによってクラスタ クォーラムを確立できるため、単一ノードの障害に耐えることができます。2ノードクラスタは、ONTAP Deploy VM によってホストされるメディエータ サービスに依存して同じ結果を実現します。

ONTAP Select ノードと ONTAP Deploy メディエーターサービスの間のハートビートネットワークトラフィックは最小限かつ耐障害性があるため、 ONTAP Deploy VM を 2 ノード ONTAP Select クラスタとは別のデータセンターでホストすることが可能です。


NOTE: 2 ノードクラスタのメディエーターとして機能する場合、 ONTAP Deploy VM はそのクラスタに不可欠な要素です。メディエーターサービスを使用できない場合、 2 ノードクラスタはデータの提供を続けますが、 ONTAP Select クラスタのストレージフェイルオーバー機能は無効になります。このため、 ONTAP Deploy のメディエーターサービスは、 HA ペアの各 ONTAP Select ノードとの安定的な通信を維持する必要があります。クラスタクォーラムを適切に機能させるには、最小帯域幅が 5Mbps 、 RTT （最大ラウンドトリップ時間）が 125 ミリ秒でなければなりません。

メディエーターとして機能する ONTAP Deploy VM が一時的に使用できない場合、または永久に使用できなくなる可能性がある場合は、セカンダリ ONTAP Deploy VM を使用して 2 ノードクラスタクォーラムをリストアできます。その結果、新しい ONTAP Deploy VM は ONTAP Select ノードを管理できませんが、クラスタクォーラムのアルゴリズムには問題なく追加されます。ONTAP Select ノードと ONTAP Deploy VM の間の通信には、 IPv4 経由の iSCSI プロトコルが使用されます。ONTAP Select ノードの管理 IP アドレスがイニシエータで、 ONTAP Deploy VM の IP アドレスがターゲットです。したがって、 2 ノードクラスタを作成する場合、ノード管理 IP アドレスの IPv6 アドレスはサポートできません。2 ノードクラスタの作成時に、 ONTAP Deploy でホストされるメールボックスディスクが自動的に作成され、適切な ONTAP Select ノード管理 IP アドレスにマスクされます。設定はすべてセットアップ時に自動的に行われ、管理操作は不要です。クラスタを作成する ONTAP Deploy インスタンスが、そのクラスタのデフォルトのメディエーターとなります。

メディエーターの元の場所を変更する必要がある場合は、管理操作が必要です。元の ONTAP Deploy VM が失われた場合でもクラスタクォーラムをリカバリすることは可能ですが、ネットアップでは、 2 ノードクラスタがインスタンス化されるたびに ONTAP Deploy データベースをバックアップすることを推奨します。



== 2 ノード HA と 2 ノードストレッチ HA （ MetroCluster SDS ）の比較

2 ノードのアクティブ / アクティブ HA クラスタをより長い距離に伸長し、各ノードを異なるデータセンターに配置することが可能です。2 ノードクラスタと 2 ノードストレッチクラスタ（別名 MetroCluster SDS ）の唯一の違いは、ノード間のネットワーク接続距離です。

2 ノードクラスタとは、同じデータセンター内にある 2 つのノードが 300m 以内の範囲に配置されているクラスタです。一般に、両方のノードには、同じネットワークスイッチまたは一連の Interswitch Link （ ISL ；スイッチ間リンク）ネットワークスイッチへのアップリンクがあります。

2 ノード MetroCluster SDS とは、別の部屋、別の建物、別のデータセンターなど、物理的に 300m 以上離れたノードを持つクラスタです。さらに、各ノードのアップリンク接続は、別々のネットワークスイッチに接続されます。MetroCluster SDS には専用ハードウェアは必要ありません。ただし、環境はレイテンシの要件（ RTT の最大 5 ミリ秒とジッタの 5 ミリ秒の合計 10 ミリ秒）と物理距離の要件（最大 10km ）に準拠している必要があります。

MetroCluster SDSはプレミアム機能であり、プレミアムライセンスまたはプレミアムXLライセンスが必要です。Premium ライセンスは、中小規模の VM のほか、 HDD および SSD メディアの作成をサポートします。Premium XLライセンスではNVMeドライブの作成もサポートされます。


NOTE: MetroCluster SDS は、ローカル接続ストレージ（ DAS ）と共有ストレージ（ vNAS ）の両方でサポートされます。通常、 vNAS 構成では、 ONTAP Select VM と共有ストレージとの間のネットワークが原因で、本来のレイテンシが大きくなります。MetroCluster SDS 構成では、共有ストレージのレイテンシを含め、ノード間で最大 10 ミリ秒のレイテンシを実現する必要があります。つまり、これらの構成では共有ストレージのレイテンシを無視できないため、 Select VM 間のレイテンシを測定するだけでは不十分です。
