---
sidebar: sidebar 
permalink: concept_nw_single_multi_node.html 
keywords: ontap select, single node network configuration, multi-node network configuration 
summary: ONTAP Selectは、単一ノードと複数ノードの両方のネットワーク構成をサポートします。 
---
= ONTAP Selectのシングルノードおよびマルチノードのネットワーク構成
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP Selectは、シングルノードとマルチノードの両方のネットワーク構成をサポートします。



== シングルノードネットワーク構成

シングルノード ONTAP Select 構成では、クラスタトラフィック、 HA トラフィック、ミラートラフィックが発生しないため、 ONTAP 内部ネットワークは必要ありません。

ONTAP Select製品のマルチノード版とは異なり、各ONTAP Select VMには3つの仮想ネットワークアダプタが含まれ、ONTAPネットワークポートe0a、e0b、およびe0cに提供されます。

これらのポートを使用して、管理 LIF 、データ LIF 、クラスタ間 LIF のサービスが提供されます。

.KVM の略
ONTAP Selectをシングルノード クラスタとして導入できます。ハイパーバイザー ホストには、外部ネットワークへのアクセスを提供する仮想スイッチが含まれています。

.ESXi
次の図は、これらのポートと基盤となる物理アダプタの関係を示しています。この図は、ESXiハイパーバイザー上のONTAP Selectクラスタノードを示しています。

* シングルノード ONTAP Select クラスタのネットワーク構成 *

image:DDN_03.jpg["シングルノード ONTAP Select クラスタのネットワーク構成"]


NOTE: シングルノードクラスタには 2 つのアダプタで十分ですが、 NIC チーミングは必要です。



=== LIF の割り当て

このドキュメントのマルチノードLIF割り当てセクションで説明されているように、ONTAPはIPspacesを使用してクラスタ ネットワーク トラフィックをデータおよび管理トラフィックとは分離します。このプラットフォームのシングルノード バリアントには、クラスタ ネットワークは含まれません。したがって、クラスター IPspaceにはポートが存在しません。


NOTE: クラスタとノードの管理LIFは、ONTAP Selectクラスタのセットアップ時に自動的に作成されます。残りのLIFはデプロイメント後に作成できます。



=== 管理 LIF とデータ LIF （ e0a 、 e0b 、 e0c ）

ONTAP ポート e0a 、 e0b 、 e0c は、次のタイプのトラフィックを処理する LIF の候補ポートとして委譲されました。

* SAN / NAS プロトコルのトラフィック（ CIFS 、 NFS 、 iSCSI ）
* クラスタ、ノード、および SVM の管理トラフィック
* クラスタ間トラフィック（ SnapMirror 、 SnapVault ）




== マルチノード ネットワーク構成

マルチノードONTAP Selectネットワーク構成は2つのネットワークで構成されます。

これらは、クラスタおよび内部レプリケーション サービスを提供する内部ネットワークと、データ アクセスおよび管理サービスを提供する外部ネットワークです。これら 2 つのネットワーク内を流れるトラフィックをエンドツーエンドで分離することは、クラスタの回復力に適した環境を構築する上で非常に重要です。

これらのネットワークは次の図に示されています。これは、VMware vSphere プラットフォーム上で実行されている 4 ノードのONTAP Selectクラスタを示しています。66 ノード、8 ノード、10 ノード、および 12 ノードのクラスターには同様のネットワーク レイアウトがあります。


NOTE: 各 ONTAP Select インスタンスは、別々の物理サーバに存在します。内部トラフィックと外部トラフィックは別々のネットワークポートグループを使用して分離されます。ネットワークポートグループは各仮想ネットワークインターフェイスに割り当てられ、クラスタノードは同じ物理スイッチインフラを共有できます。

*ONTAP Selectマルチノードクラスタネットワーク構成の概要*

image:DDN_01.jpg["ONTAP Selectマルチノードクラスタネットワーク構成の概要"]

各 ONTAP Select VM には、 7 つのネットワークポート、 e0a~e0g のセットとして ONTAP に提示される 7 つの仮想ネットワークアダプタが含まれています。ONTAP はこれらのアダプタを物理 NIC として扱いますが、実際には仮想 NIC であり、仮想化されたネットワークレイヤを通じて一連の物理インターフェイスにマッピングされます。このため、各ホスティングサーバに 6 つの物理ネットワークポートを用意する必要はありません。


NOTE: ONTAP Select VM に仮想ネットワークアダプタを追加することはできません。

これらのポートは、次のサービスを提供するように事前設定されています。

* e0a 、 e0b 、および e0g ：管理 LIF とデータ LIF
* e0c 、 e0d 。クラスタネットワーク LIF
* e0e 、RSM （ RSM ）
* e0f ：HA インターコネクト


ポートe0a、e0b、およびe0gは外部ネットワーク上に存在します。ポートe0cからe0fはいくつかの異なる機能を実行しますが、全体として内部Selectネットワークを構成します。ネットワーク設計を決定するときは、これらのポートを単一のレイヤー2ネットワークに配置する必要があります。これらの仮想アダプターを異なるネットワーク間で分離する必要はありません。

これらのポートと基盤となる物理アダプタの関係を次の図に示します。この図は、ESXiハイパーバイザー上の1つのONTAP Selectクラスタノードを示しています。

*マルチノードONTAP Selectクラスタの一部である単一ノードのネットワーク構成*image:DDN_02.jpg["マルチノードONTAP Selectクラスタの一部である単一ノードのネットワーク構成"]

内部トラフィックと外部トラフィックを異なる物理NICに分離することで、ネットワーク リソースへの不十分なアクセスを防ぎ、システムに遅延が発生するのを防ぎます。さらに、NICチーミングによる集約により、単一のネットワーク アダプタに障害が発生した場合でも、ONTAP Selectクラスタ ノードはネットワークへのアクセスを継続できます。


NOTE: 外部ネットワーク ポート グループと内部ネットワーク ポート グループの両方に、4つのNICアダプタすべてが対称的に含まれています。外部ネットワーク ポート グループ内のアクティブ ポートは、内部ネットワーク内のスタンバイ ポートです。逆に、内部ネットワーク ポート グループ内のアクティブ ポートは、外部ネットワーク ポート グループ内のスタンバイ ポートになります。



=== LIF の割り当て

IPspace の導入に伴い、 ONTAP ポートロールは廃止されました。FAS アレイと同様に、 ONTAP Select クラスタにはデフォルト IPspace とクラスタ IPspace の両方が含まれます。ネットワークポート e0a 、 e0b 、 e0g をデフォルト IPspace に配置し、ポート e0c と e0d をクラスタ IPspace に配置することで、これらのポートが所属外の LIF をホストすることはなくなりました。ONTAP Select クラスタ内の残りのポートは、インターフェイスの自動割り当てを通じて使用されて内部サービスを提供します。RSM インターフェイスや HA インターコネクトインターフェイスと同様に、これらのポートに ONTAP シェルを通じてアクセスすることはできません。


NOTE: すべての LIF に ONTAP コマンドシェルからアクセスできるわけではありません。HA インターコネクトインターフェイスと RSM インターフェイスは ONTAP からは認識されず、内部で使用されてそれぞれのサービスを提供します。

ネットワークポートと LIF については、このあとのセクションで詳しく説明します。



=== 管理 LIF とデータ LIF （ e0a 、 e0b 、 e0g ）

ONTAP ポート e0a 、 e0b 、 e0g は、次のタイプのトラフィックを処理する LIF の候補ポートとして委譲されました。

* SAN / NAS プロトコルのトラフィック（ CIFS 、 NFS 、 iSCSI ）
* クラスタ、ノード、および SVM の管理トラフィック
* クラスタ間トラフィック（ SnapMirror 、 SnapVault ）



NOTE: クラスタとノードの管理LIFは、ONTAP Selectクラスタのセットアップ時に自動的に作成されます。残りのLIFはデプロイメント後に作成できます。



=== クラスタネットワーク LIF （ e0c 、 e0d ）

ONTAP のポート e0c と e0d は、クラスタインターフェイスのホームポートとして委譲されました。各 ONTAP Select クラスタノード内では、 ONTAP のセットアップ時にリンクローカルの IP アドレス（ 169.254.x.x ）を使用して自動的に 2 つのクラスタインターフェイスが生成されます。


NOTE: これらのインターフェイスに静的 IP アドレスを割り当てることはできません。また、追加のクラスタ インターフェイスを作成しないでください。

クラスタネットワーク トラフィックは、低レイテンシでルーティングされないレイヤー2ネットワークを経由する必要があります。クラスタのスループットとレイテンシの要件により、ONTAP Selectクラスタを物理的に近接した場所（たとえば、マルチパック、単一のデータセンター）に配置する必要があります。WANまたは地理的に離れた場所を介してHAノードを分離して、4、6、8、10、または12ノードのストレッチクラスタ構成を構築することはサポートされていません。メディエーターを使用した拡張2ノード構成がサポートされています。

詳細については、を参照してください link:reference_plan_best_practices.html#two-node-stretched-ha-metrocluster-sds-best-practices["2 ノードストレッチ HA （ MetroCluster SDS ）のベストプラクティス"]。


NOTE: クラスタ ネットワーク トラフィックの最大スループットを確保するため、このネットワーク ポートは、ジャンボ フレーム（7500～9000 MTU）を使用するように構成されています。クラスタを正しく動作させるには、ONTAP Select クラスタ ノードに内部ネットワーク サービスを提供する上流のすべての仮想スイッチと物理スイッチでジャンボ フレームが有効になっていることを確認してください。



=== RAID SyncMirror トラフィック（ e0e ）

HA パートナーノード間でのブロックの同期レプリケーションは、ネットワークポート e0e 上の内部ネットワークインターフェイスを使用して実行されます。この処理は、クラスタセットアップ時に ONTAP で設定されたネットワークインターフェイスを使用して自動的に実行され、管理者による設定を必要としません。


NOTE: ポートe0eは、ONTAPによって内部レプリケーション トラフィック用に予約されています。そのため、ポートもホストされているLIFも、ONTAP CLIまたはSystem Managerには表示されません。このインターフェイスは、自動的に生成されたリンク ローカルIPアドレスを使用するように設定されており、代替IPアドレスを割り当てることはできません。このネットワーク ポートでは、ジャンボ フレーム（7500～9000 MTU）を使用する必要があります。



=== HA インターコネクト（ e0f ）

NetApp FAS アレイは、専用のハードウェアを使用して ONTAP クラスタの HA ペア間で情報をやり取りします。ただし、 Software-Defined 環境ではこの種の機器（ InfiniBand デバイスや iWARP デバイスなど）が使用されないことが多いため、別の解決策 が必要となります。いくつかのオプションが検討されましたが、インターコネクトの転送に関する ONTAP の要件を満たすためには、この機能をソフトウェアでエミュレートする必要がありました。このため、 ONTAP Select クラスタ内では、 HA インターコネクトの機能（従来はハードウェアが提供）が OS に組み込まれ、イーサネットが転送メカニズムとして使用されます。

各 ONTAP Select ノードに HA インターコネクトポート e0f が設定されます。このポートは、 HA インターコネクトのネットワークインターフェイスをホストし、次の 2 つの主要機能を提供します。

* HA ペア間で NVRAM の内容をミラーリングします
* HA ペア間で HA ステータス情報とネットワークハートビートメッセージを送受信する


イーサネットパケット内に Remote Direct Memory Access （ RDMA ）フレームをレイヤ化することで、 HA インターコネクトトラフィックは、単一のネットワークインターフェイスを使用してこのネットワークポートを経由します。


NOTE: RSMポート（e0e）と同様に、物理ポートもホストされているネットワークインターフェイスも、ONTAP CLIまたはSystem Managerからユーザーには表示されません。その結果、このインターフェイスのIPアドレスを変更することはできず、ポートの状態を変更することもできません。このネットワークポートでは、ジャンボフレーム（7500～9000 MTU）を使用する必要があります。
