---
sidebar: sidebar 
permalink: concept_nw_single_multi_node.html 
keywords: ontap select, single node network configuration, multinode network configuration 
summary: ONTAP Select は、シングルノードとマルチノードの両方のネットワーク構成をサポートします。 
---
= シングルノードおよびマルチノードのネットワーク構成
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP Select は、シングルノードとマルチノードの両方のネットワーク構成をサポートします。



== シングルノードネットワーク構成

シングルノード ONTAP Select 構成では、クラスタトラフィック、 HA トラフィック、ミラートラフィックが発生しないため、 ONTAP 内部ネットワークは必要ありません。

マルチノードバージョンの ONTAP Select 製品とは異なり、各 ONTAP Select VM は 3 つの仮想ネットワークアダプタを搭載し、それぞれのアダプタを ONTAP ネットワークポート e0a 、 e0b 、 e0c に提供します。

これらのポートを使用して、管理 LIF 、データ LIF 、クラスタ間 LIF のサービスが提供されます。

.KVM の略
ONTAP Selectはシングルノードクラスタとして導入できます。ハイパーバイザーホストには、外部ネットワークへのアクセスを提供する仮想スイッチが含まれています。

.ESXi
次の図に、これらのポートと基盤の物理アダプタとの関係を示します。この図は、 ESX ハイパーバイザー上にある 1 つの ONTAP Select クラスタノードを表しています。

* シングルノード ONTAP Select クラスタのネットワーク構成 *

image:DDN_03.jpg["シングルノード ONTAP Select クラスタのネットワーク構成"]


NOTE: シングルノードクラスタには 2 つのアダプタで十分ですが、 NIC チーミングは必要です。



=== LIF の割り当て

マルチノードの LIF の割り当てに関するセクションで説明したように、 ONTAP Select では、クラスタネットワークトラフィックをデータトラフィックと管理トラフィックから分離するために IPspace が使用されます。このプラットフォームのシングルノードバージョンにはクラスタネットワークが含まれません。したがって、クラスタ IPspace にはポートがありません。


NOTE: クラスタとノードの管理 LIF は、 ONTAP Select クラスタのセットアップ時に自動的に作成されます。残りの LIF は導入後に作成できます。



=== 管理 LIF とデータ LIF （ e0a 、 e0b 、 e0c ）

ONTAP ポート e0a 、 e0b 、 e0c は、次のタイプのトラフィックを処理する LIF の候補ポートとして委譲されました。

* SAN / NAS プロトコルのトラフィック（ CIFS 、 NFS 、 iSCSI ）
* クラスタ、ノード、および SVM の管理トラフィック
* クラスタ間トラフィック（ SnapMirror 、 SnapVault ）




== マルチノードネットワーク構成

マルチノードの ONTAP Select ネットワーク構成は、 2 つのネットワークで構成されます。

これらは、クラスタおよび内部レプリケーションサービスを提供する内部ネットワークと、データアクセスおよび管理サービスを提供する外部ネットワークです。この 2 つのネットワークを経由するトラフィックがエンドツーエンドで分離されていることは、クラスタの耐障害性を高める環境を構築できる点できわめて重要です。

次の図は、 VMware vSphere プラットフォームで稼働する 4 ノードの ONTAP Select クラスタにおけるこの 2 つのネットワークを示しています。6 ノードクラスタと 8 ノードクラスタのネットワークレイアウトは似ています。


NOTE: 各 ONTAP Select インスタンスは、別々の物理サーバに存在します。内部トラフィックと外部トラフィックは別々のネットワークポートグループを使用して分離されます。ネットワークポートグループは各仮想ネットワークインターフェイスに割り当てられ、クラスタノードは同じ物理スイッチインフラを共有できます。

* ONTAP Select のマルチノードクラスタネットワーク構成の概要 *

image:DDN_01.jpg["ONTAP Select のマルチノードクラスタネットワーク構成の概要"]

各 ONTAP Select VM には、 7 つのネットワークポート、 e0a~e0g のセットとして ONTAP に提示される 7 つの仮想ネットワークアダプタが含まれています。ONTAP はこれらのアダプタを物理 NIC として扱いますが、実際には仮想 NIC であり、仮想化されたネットワークレイヤを通じて一連の物理インターフェイスにマッピングされます。このため、各ホスティングサーバに 6 つの物理ネットワークポートを用意する必要はありません。


NOTE: ONTAP Select VM に仮想ネットワークアダプタを追加することはできません。

これらのポートは、次のサービスを提供するように事前設定されています。

* e0a 、 e0b 、および e0g ：管理 LIF とデータ LIF
* e0c 、 e0d 。クラスタネットワーク LIF
* e0e 、RSM （ RSM ）
* e0f ：HA インターコネクト


ポート e0a 、 e0b 、 e0g は外部ネットワークにあります。ポート e0c~e0f はそれぞれに異なる機能を実行しますが、全体として内部 Select ネットワークを構成します。ネットワーク設計を決める際には、これらのポートを同じ 1 つのレイヤ 2 ネットワークに配置する必要があります。これらの仮想アダプタを別々のネットワークに分ける必要はありません。

次の図は、これらのポートと基盤の物理アダプタとの関係を示しています。この図は、 ESX ハイパーバイザー上にある 1 つの ONTAP Select クラスタノードを表しています。

* マルチノード ONTAP Select クラスタ * の一部であるシングルノードのネットワーク構成

image:DDN_02.jpg["マルチノード ONTAP Select クラスタの一部であるシングルノードのネットワーク構成"]

内部と外部のトラフィックを異なる物理 NIC に分離することで、ネットワークリソースへの不十分なアクセスが原因でシステムに遅延が発生することを防止できます。NIC チーミングを使用したアグリゲーションによって、 1 つのネットワークアダプタで障害が発生しても、 ONTAP Select クラスタノードが対応するネットワークにアクセスできなくなることもありません。

外部ネットワークポートグループと内部ネットワークポートグループの両方に、 4 つの NIC アダプタが対称的に含まれていることに注意してください。外部ネットワークポートグループのアクティブポートは、内部ネットワークのスタンバイポートです。逆に、内部ネットワークポートグループのアクティブポートは、外部ネットワークポートグループのスタンバイポートです。



=== LIF の割り当て

IPspace の導入に伴い、 ONTAP ポートロールは廃止されました。FAS アレイと同様に、 ONTAP Select クラスタにはデフォルト IPspace とクラスタ IPspace の両方が含まれます。ネットワークポート e0a 、 e0b 、 e0g をデフォルト IPspace に配置し、ポート e0c と e0d をクラスタ IPspace に配置することで、これらのポートが所属外の LIF をホストすることはなくなりました。ONTAP Select クラスタ内の残りのポートは、インターフェイスの自動割り当てを通じて使用されて内部サービスを提供します。RSM インターフェイスや HA インターコネクトインターフェイスと同様に、これらのポートに ONTAP シェルを通じてアクセスすることはできません。


NOTE: すべての LIF に ONTAP コマンドシェルからアクセスできるわけではありません。HA インターコネクトインターフェイスと RSM インターフェイスは ONTAP からは認識されず、内部で使用されてそれぞれのサービスを提供します。

ネットワークポートと LIF については、このあとのセクションで詳しく説明します。



=== 管理 LIF とデータ LIF （ e0a 、 e0b 、 e0g ）

ONTAP ポート e0a 、 e0b 、 e0g は、次のタイプのトラフィックを処理する LIF の候補ポートとして委譲されました。

* SAN / NAS プロトコルのトラフィック（ CIFS 、 NFS 、 iSCSI ）
* クラスタ、ノード、および SVM の管理トラフィック
* クラスタ間トラフィック（ SnapMirror 、 SnapVault ）



NOTE: クラスタとノードの管理 LIF は、 ONTAP Select クラスタのセットアップ時に自動的に作成されます。残りの LIF は導入後に作成できます。



=== クラスタネットワーク LIF （ e0c 、 e0d ）

ONTAP のポート e0c と e0d は、クラスタインターフェイスのホームポートとして委譲されました。各 ONTAP Select クラスタノード内では、 ONTAP のセットアップ時にリンクローカルの IP アドレス（ 169.254.x.x ）を使用して自動的に 2 つのクラスタインターフェイスが生成されます。


NOTE: これらのインターフェイスには静的 IP アドレスを割り当てることができず、クラスタインターフェイスを追加で作成することはできません。

クラスタネットワークトラフィックは、低レイテンシのルーティングされないレイヤ 2 ネットワークで処理される必要があります。クラスタのスループットとレイテンシの要件を満たすためには、 ONTAP Select クラスタを物理的に近い距離に配置する必要があります（たとえば複数のユニットからなる単一のデータセンターなど）。WAN 内または長距離に HA ノードを分離して、 4 ノード、 6 ノード、または 8 ノードのストレッチクラスタ構成を構築することはできません。メディエーターを使用した 2 ノードのストレッチ構成はサポートされています。

詳細については、を参照してください link:reference_plan_best_practices.html#two-node-stretched-ha-metrocluster-sds-best-practices["2 ノードストレッチ HA （ MetroCluster SDS ）のベストプラクティス"]。


NOTE: クラスタネットワークトラフィックのスループットを最大限にするため、このネットワークポートはジャンボフレーム（ 7 、 500~9 、 000MTU ）を使用するように設定されます。クラスタを適切に動作させるために、 ONTAP Select クラスタノードに内部ネットワークサービスを提供するアップストリームのすべての仮想スイッチと物理スイッチでジャンボフレームが有効になっていることを確認してください。



=== RAID SyncMirror トラフィック（ e0e ）

HA パートナーノード間でのブロックの同期レプリケーションは、ネットワークポート e0e 上の内部ネットワークインターフェイスを使用して実行されます。この処理は、クラスタセットアップ時に ONTAP で設定されたネットワークインターフェイスを使用して自動的に実行され、管理者による設定を必要としません。


NOTE: ポート e0e は、 ONTAP によって内部レプリケーショントラフィック用に予約されています。そのため、ポートもホストされている LIF も、 ONTAP の CLI や System Manager では認識されません。このインターフェイスは、自動生成されるリンクローカルの IP アドレスを使用するように設定され、別の IP アドレスに変更することはできません。このネットワークポートでは、ジャンボフレーム（ 7 、 500~9 、 000MTU ）を使用する必要があります。



=== HA インターコネクト（ e0f ）

NetApp FAS アレイは、専用のハードウェアを使用して ONTAP クラスタの HA ペア間で情報をやり取りします。ただし、 Software-Defined 環境ではこの種の機器（ InfiniBand デバイスや iWARP デバイスなど）が使用されないことが多いため、別の解決策 が必要となります。いくつかのオプションが検討されましたが、インターコネクトの転送に関する ONTAP の要件を満たすためには、この機能をソフトウェアでエミュレートする必要がありました。このため、 ONTAP Select クラスタ内では、 HA インターコネクトの機能（従来はハードウェアが提供）が OS に組み込まれ、イーサネットが転送メカニズムとして使用されます。

各 ONTAP Select ノードに HA インターコネクトポート e0f が設定されます。このポートは、 HA インターコネクトのネットワークインターフェイスをホストし、次の 2 つの主要機能を提供します。

* HA ペア間で NVRAM の内容をミラーリングします
* HA ペア間で HA ステータス情報とネットワークハートビートメッセージを送受信する


イーサネットパケット内に Remote Direct Memory Access （ RDMA ）フレームをレイヤ化することで、 HA インターコネクトトラフィックは、単一のネットワークインターフェイスを使用してこのネットワークポートを経由します。


NOTE: RSM ポート（ e0e ）の場合と同様に、この物理ポートもホストされているネットワークインターフェイスも、 ONTAP CLI や System Manager では認識されません。このため、このインターフェイスの IP アドレスは変更できず、ポートの状態も変更できません。このネットワークポートでは、ジャンボフレーム（ 7 、 500~9 、 000MTU ）を使用する必要があります。
